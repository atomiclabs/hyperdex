{"version":3,"file":"asarFileChecker.js","sourceRoot":"","sources":["../../src/asar/asarFileChecker.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAA,AAAO,AAAE,AAAU,AAAE,AAAM,AAAqB;;;;;;;;;;AAChD,AAAO,AAAQ,AAAQ,AAAE,AAAM,AAAQ;;;;;;;;;;AAEvC,AAAgB,AAChB,AAAM;;2CAAC,AAAK,WAA6B,AAAgB,UAAE,AAAoB,cAAE,AAAqB;AACpG,mBAAe,AAAY;AACzB,aAAO,IAAI,AAAK,AAAC,SAAG,AAAa,kBAAK,AAAY,yBAAa,AAAQ,aAAK,AAAI,IAAE,AAAC,AACrF;AAAC;;AAED,QAAI,AAAE;;AACN,QAAI;AACF,AAAE,WAAG,MAAM,AAAQ,sBAAC,AAAQ,AAAC;AAC9B,MACD,OAAO,AAAC,GAAE;AACR,YAAM,AAAK,AAAC,uBAAiB,AAAC,CAAE,AAAC;AAClC;;AAED,QAAI,AAAiB;;AACrB,QAAI;AACF,AAAI,aAAG,AAAE,GAAC,AAAO,QAAC,AAAY,AAAC;AAChC,MACD,OAAO,AAAC;AACN,YAAM,AAAQ,WAAG,MAAM,AAAU,sBAAC,AAAQ,AAAC;;AAC3C,UAAI,AAAQ,YAAI,AAAI,MAAE;AACpB,cAAM,AAAK,AAAC,MAAmD,AAAC;AACjE,OAJO,CAMR,AAA8D;;;AAC9D,AAAI,aAAG,AAAI;AACZ;;AAED,QAAI,AAAI,QAAI,AAAI,MAAE;AAChB,YAAM,AAAK,AAAC,MAAmD,AAAC;AACjE;;AACD,QAAI,AAAI,KAAC,AAAI,SAAK,AAAC,GAAE;AACnB,YAAM,AAAK,AAAC,MAAsB,AAAC;AACpC,AACH;AAAC","sourcesContent":["import { statOrNull } from \"builder-util/out/fs\"\nimport { Node, readAsar } from \"./asar\"\n\n/** @internal */\nexport async function checkFileInArchive(asarFile: string, relativeFile: string, messagePrefix: string) {\n  function error(text: string) {\n    return new Error(`${messagePrefix} \"${relativeFile}\" in the \"${asarFile}\" ${text}`)\n  }\n\n  let fs\n  try {\n    fs = await readAsar(asarFile)\n  }\n  catch (e) {\n    throw error(`is corrupted: ${e}`)\n  }\n\n  let stat: Node | null\n  try {\n    stat = fs.getFile(relativeFile)\n  }\n  catch (e) {\n    const fileStat = await statOrNull(asarFile)\n    if (fileStat == null) {\n      throw error(`does not exist. Seems like a wrong configuration.`)\n    }\n\n    // asar throws error on access to undefined object (info.link)\n    stat = null\n  }\n\n  if (stat == null) {\n    throw error(`does not exist. Seems like a wrong configuration.`)\n  }\n  if (stat.size === 0) {\n    throw error(`is corrupted: size 0`)\n  }\n}\n"]}
